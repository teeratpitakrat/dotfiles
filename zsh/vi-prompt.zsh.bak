# urxvt (and family) accepts even #RRGGBB
INSERT_PROMPT="white"
COMMAND_PROMPT="red"

export KEYTIMEOUT=1

# helper for setting color including all kinds of terminals
set_prompt_color() {
	if [[ $TERM = "linux" ]]; then
		# nothing
	elif [[ $TMUX != '' ]]; then
		printf '\033Ptmux;\033\033]12;%b\007\033\\' "$1"
	else
		echo -ne "\033]12;$1\007"
	fi
}

# change cursor color basing on vi mode
zle-keymap-select () {
	if [ $KEYMAP = vicmd ]; then
		set_prompt_color $COMMAND_PROMPT
	else
		set_prompt_color $INSERT_PROMPT
	fi
}

zle-line-finish() {
	set_prompt_color $INSERT_PROMPT
}

zle-line-init () {
	zle -K viins
	set_prompt_color $INSERT_PROMPT
}

zle -N zle-keymap-select
zle -N zle-line-init
zle -N zle-line-finish
